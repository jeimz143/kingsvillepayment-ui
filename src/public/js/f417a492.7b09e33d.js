(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["f417a492"],{"02b0":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-search",{attrs:{placeholder:"Type Fee Code",autofocus:""},model:{value:e.feeItemCode,callback:function(t){e.feeItemCode=t},expression:"feeItemCode"}},[a("q-autocomplete",{attrs:{"min-characters":0},on:{selected:e.getFeeItem,search:e.getFeeCode}})],1)],1)},n=[];o._withStripped=!0;a("7f7f");var r=a("2b0e"),i=a("2ef0"),l=a.n(i),s=a("7bb4"),c=r["default"].extend({name:"CodeFeeInput",created:function(){this.params.value&&(this.feeItemCode=this.params.value)},mounted:function(){var e=this;e.getFeeCode()},data:function(){return{feeItemCode:"",feeItemLists:[]}},methods:{mapFeeItems:function(e){return l.a.map(e,function(e){return{label:e.code+" - "+e.name,value:e.code}})},getFeeItem:function(e){this.feeItemCode=e.value,this.params.stopEditing()},getFeeCode:function(e,t){var a=this,o=[],n={terms:e};s["a"].PickList(n).then(function(e){if(200===e.status)if(e.data.error)a.$q.notify({color:"negative",message:e.data.error,position:"top"}),void 0!==t&&t(o);else{var n=JSON.parse(JSON.stringify(e.data));o=a.mapFeeItems(n),void 0!==t&&(a.$store.dispatch("Fee/listAll",n),t(o))}},function(e){a.$q.notify({message:e.response.data.error,position:"top",type:"negative"})})},getValue:function(){return this.feeItemCode}}}),u=c,d=a("2877"),f=Object(d["a"])(u,o,n,!1,null,null,null);f.options.__file="CodeFeeInput.vue";t["a"]=f.exports},"0676":function(e,t){function a(){throw new TypeError("Invalid attempt to spread non-iterable instance")}e.exports=a},"11b0":function(e,t,a){var o=a("2a06"),n=a("883d");function r(e){if(n(Object(e))||"[object Arguments]"===Object.prototype.toString.call(e))return o(e)}e.exports=r},"20fd":function(e,t,a){"use strict";var o=a("d9f6"),n=a("aebd");e.exports=function(e,t,a){t in e?o.f(e,t,n(0,a)):e[t]=a}},2236:function(e,t){function a(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}e.exports=a},"2a06":function(e,t,a){e.exports=a("d2d5")},"2fbd":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-input",{attrs:{type:"number",autofocus:""},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete"]))return null;e.model=0},blur:e.onBlur,focus:function(t){e.parseTwoDecimal()}},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)},n=[];o._withStripped=!0;var r=a("2b0e"),i=r["default"].extend({name:"NumberInput",created:function(){this.params.value&&(this.model=this.params.value)},data:function(){return{model:0}},methods:{parseTwoDecimal:function(){},getValue:function(){return this.model},onBlur:function(){this.params.stopEditing()}}}),l=i,s=a("2877"),c=Object(s["a"])(l,o,n,!1,null,null,null);c.options.__file="NumberInput.vue";t["a"]=c.exports},"448a":function(e,t,a){var o=a("2236"),n=a("11b0"),r=a("0676");function i(e){return o(e)||n(e)||r()}e.exports=i},"549b":function(e,t,a){"use strict";var o=a("d864"),n=a("63b6"),r=a("241e"),i=a("b0dc"),l=a("3702"),s=a("b447"),c=a("20fd"),u=a("7cd6");n(n.S+n.F*!a("4ee1")(function(e){Array.from(e)}),"Array",{from:function(e){var t,a,n,d,f=r(e),m="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,h=void 0!==v,b=0,g=u(f);if(h&&(v=o(v,p>2?arguments[2]:void 0,2)),void 0==g||m==Array&&l(g))for(t=s(f.length),a=new m(t);t>b;b++)c(a,b,h?v(f[b],b):f[b]);else for(d=g.call(f),a=new m;!(n=d.next()).done;b++)c(a,b,h?i(d,v,[n.value,b],!0):n.value);return a.length=b,a}})},"54a1":function(e,t,a){a("6c1c"),a("1654"),e.exports=a("95d5")},"883d":function(e,t,a){e.exports=a("54a1")},"95d5":function(e,t,a){var o=a("40c3"),n=a("5168")("iterator"),r=a("481b");e.exports=a("584a").isIterable=function(e){var t=Object(e);return void 0!==t[n]||"@@iterator"in t||r.hasOwnProperty(o(t))}},d2d5:function(e,t,a){a("1654"),a("549b"),e.exports=a("584a").Array.from},e258:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"form q-pa-lg"},[a("div",{staticClass:"row gutter-sm"},[a("div",{staticClass:"col-xs-12 col-md-6"},[a("q-field",{attrs:{label:"Select School Year:",orientation:"vertical"}},[a("q-search",{attrs:{placeholder:"Type School Year."},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete"]))return null;e.deleteSchoolYear()}},model:{value:e.form.schoolYearCode,callback:function(t){e.$set(e.form,"schoolYearCode",t)},expression:"form.schoolYearCode"}},[a("q-autocomplete",{attrs:{"min-characters":0},on:{selected:e.getSelectedSchoolYear,search:e.getSchoolYear}})],1)],1)],1),a("div",{staticClass:"col-xs-12 col-md-6"}),a("div",{staticClass:"col-xs-12 col-md-6"},[a("q-field",{attrs:{label:"Student's No.:",orientation:"vertical"}},[a("q-search",{attrs:{placeholder:"Type Student No."},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete"]))return null;e.deleteStudent()}},model:{value:e.form.studentNumber,callback:function(t){e.$set(e.form,"studentNumber",t)},expression:"form.studentNumber"}},[a("q-autocomplete",{attrs:{"min-characters":0},on:{selected:e.getSelectedStudent,search:e.getStudent}})],1)],1)],1),a("div",{staticClass:"col-xs-12 col-md-6"},[a("q-field",{attrs:{label:"Student's Name.:",orientation:"vertical"}},[a("q-input",{attrs:{readonly:""},model:{value:e.form.studentName,callback:function(t){e.$set(e.form,"studentName",t)},expression:"form.studentName"}})],1)],1),a("div",{staticClass:"col-xs-12 col-md-6"},[a("q-field",{attrs:{label:"In-Cash / Monthly Base","label-width":"4",orientation:"vertical"}},[a("q-select",{attrs:{inline:"",color:"secondary",radio:"",options:[{label:"",value:0},{label:"In-Cash",value:1},{label:"Monthly",value:2}]},on:{input:e.paymentTermFieldSet},model:{value:e.form.paymentTerm,callback:function(t){e.$set(e.form,"paymentTerm",t)},expression:"form.paymentTerm"}})],1)],1),a("div",{staticClass:"col-xs-12 col-md-6"},[a("q-field",{attrs:{label:"Is Scholar or With Voucher","label-width":"4",orientation:"vertical"}},[a("q-select",{attrs:{options:[{label:"Yes",value:!0},{label:"No",value:!1}]},model:{value:e.form.isScholar,callback:function(t){e.$set(e.form,"isScholar",t)},expression:"form.isScholar"}})],1)],1),0!==e.form.paymentTerm?a("div",{staticClass:"col-xs-12 col-md-6"},[a("q-field",{attrs:{label:"Grade/Level Code",orientation:"vertical"}},[a("q-search",{attrs:{placeholder:"Select Grade / Level Code"},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete"]))return null;e.deleteLevel()}},model:{value:e.form.levelCode,callback:function(t){e.$set(e.form,"levelCode",t)},expression:"form.levelCode"}},[a("q-autocomplete",{attrs:{"min-characters":0},on:{selected:e.getSelectedLevel,search:e.getLevel}})],1)],1)],1):e._e(),0!==e.form.paymentTerm?a("div",{staticClass:"col-xs-12 col-md-6"},[a("q-field",{attrs:{label:"Grade/Level Description",orientation:"vertical"}},[a("q-input",{attrs:{readonly:""},model:{value:e.form.levelDescription,callback:function(t){e.$set(e.form,"levelDescription",t)},expression:"form.levelDescription"}})],1)],1):e._e(),0!==e.form.fees.length?a("div",{staticClass:"col-xs-12"},[a("q-btn",{staticClass:"float-right",attrs:{flat:"",color:"positive",round:""},on:{click:function(t){e.onAddRow()}}},[a("q-icon",{attrs:{name:"add",size:"sm"}}),a("q-tooltip",[e._v("\n            Add New Row\n          ")])],1),a("q-btn",{staticClass:"float-right",attrs:{flat:"",color:"negative",round:""},on:{click:function(t){e.onRemoveSelected()}}},[a("q-icon",{attrs:{name:"delete",size:"sm"}}),a("q-tooltip",[e._v("\n            Remove Selected Item\n          ")])],1)],1):e._e(),0!==e.form.fees.length?a("div",{staticClass:"col-xs-12"},[a("AgGrid",{staticClass:"ag-theme-material ag-edit-page",attrs:{rowData:e.form.fees,rowSelection:e.grid.rowSelection,rowAnimation:e.grid.rowAnimation,gridOptions:e.grid.gridOptions,defaultColDef:e.grid.defaultColDef,columnDefs:e.grid.tableColumns,frameworkComponents:e.grid.frameworkComponents,overlayNoRowsTemplate:e.grid.overlayNoRowsTemplate,suppressRowClickSelection:!0},on:{"grid-ready":e.onGridReady,"cell-value-changed":e.onCellValueChanged}})],1):e._e(),a("div",{staticClass:"col-xs-12"},[a("q-btn",{on:{click:function(t){e.cancelOperation()}}},[e._v("Cancel")]),a("q-btn",{staticClass:"float-right",attrs:{type:"submit",icon:"add",color:"primary",loading:e.loading,label:"Save"},on:{click:e.saveItem}},[a("q-spinner",{attrs:{slot:"loading"},slot:"loading"})],1)],1)])])])},n=[];o._withStripped=!0;a("96cf");var r=a("c973"),i=a.n(r),l=a("448a"),s=a.n(l),c=(a("ac6a"),a("7f7f"),a("7514"),a("2ef0")),u=a.n(c),d=a("ed08"),f=a("c242"),m=a("7bb4"),p=a("7882"),v=a("1723"),h=a("659a"),b=a("2f62"),g=a("02b0"),y=a("2fbd"),S=["Fee","Item"],C=["","In-Cash","Monthly Basis"],N={name:"EnrollmentCreate",beforeMount:function(){var e=this;e.grid.overlayNoRowsTemplate='<span style="padding: 10px; border: 1px solid #eceff1; background: #fafafad6; width: 50%;">No rows to display <q-icon name=""></span>',e.grid.gridOptions={singleClickEdit:!0},e.grid.frameworkComponents={CodeFeeInput:g["a"],NumberInput:y["a"]},e.grid.tableColumns=[{headerName:"No",field:"lineNumber",width:133,sortable:!0,filter:!0,editable:!1,resizable:!0,suppressSizeToFit:!0,checkboxSelection:function(e){return!e.data.isMandatory},cellClass:function(e){return e.data.isMandatory?"not-allowed":""}},{headerName:"Type",field:"type",sortable:!0,filter:!0,resizable:!0,suppressSizeToFit:!0,editable:!1,cellEditor:"agSelectCellEditor",cellEditorParams:{values:[0,1]},valueFormatter:function(e){return Object(d["g"])(S,e.value)},valueParser:function(e){return Object(d["f"])(S,e.newValue)}},{headerName:"Code",field:"code",sortable:!0,filter:!0,resizable:!0,suppressSizeToFit:!0,editable:function(e){return!e.data.isMandatory},cellEditor:"CodeFeeInput"},{headerName:"Name",field:"name",sortable:!0,filter:!0,resizable:!0,suppressSizeToFit:!0,editable:!0},{headerName:"Description",field:"description",sortable:!0,filter:!0,resizable:!0,suppressSizeToFit:!0,editable:!0},{headerName:"Payment Term",field:"paymentTerm",sortable:!0,filter:!0,resizable:!0,suppressSizeToFit:!0,editable:function(e){return null!==e.data.type&&(1===e.data.type||"1"===e.data.type)},cellClass:function(e){return null===e.data.type||1!==e.data.type&&"1"!==e.data.type?["not-allowed"]:[]},cellEditor:"agSelectCellEditor",cellEditorParams:{values:[0,1,2]},valueFormatter:function(e){return Object(d["g"])(C,e.value)},valueParser:function(e){return Object(d["f"])(C,e.newValue)}},{headerName:"Quantity",field:"quantity",sortable:!0,filter:!0,resizable:!0,suppressSizeToFit:!0,cellEditor:"NumberInput",editable:function(e){return null!==e.data.type&&(1===e.data.type||"1"===e.data.type)},cellClass:function(e){return null===e.data.type||1!==e.data.type&&"1"!==e.data.type?"not-allowed":""},valueFormatter:function(e){return e.data.quantity?Object(d["e"])(e.data.quantity):""},cellRenderer:function(e){return e.data.quantity?Object(d["e"])(e.data.quantity):""}},{headerName:"Unit Price",field:"unitPrice",sortable:!0,filter:!0,resizable:!0,suppressSizeToFit:!0,cellEditor:"NumberInput",editable:function(e){return null!==e.data.type&&(1===e.data.type||"1"===e.data.type)},cellClass:function(e){return null===e.data.type||1!==e.data.type&&"1"!==e.data.type?"not-allowed":""},valueFormatter:function(e){return e.data.unitPrice?Object(d["e"])(e.data.unitPrice):"-"}},{headerName:"Discount (%)",field:"discount",sortable:!0,filter:!0,resizable:!0,suppressSizeToFit:!0,cellEditor:"NumberInput",editable:!0,cellClass:["pointer"],valueFormatter:function(e){return e.data.discount?Object(d["e"])(e.data.discount):""}},{headerName:"Amount",field:"amount",sortable:!0,filter:!0,resizable:!0,suppressSizeToFit:!0,cellEditor:"NumberInput",editable:!1,cellClass:["not-allowed"],valueFormatter:function(e){return e.data.amount?Object(d["e"])(e.data.amount):""}},{headerName:"Remarks",field:"remarks",sortable:!0,filter:!0,editable:!0,resizable:!0,suppressSizeToFit:!0,cellEditor:"agLargeTextCellEditor"}]},mounted:function(){var e=this;e.getOpenSchoolYear()},data:function(){return{loading:!1,levels:[],students:[],schoolyears:[],grid:{gridApi:null,overlayNoRowsTemplate:null,gridColumnApi:null,frameworkComponents:null,gridOptions:{},defaultColDef:{sortable:!0,resizable:!0,suppressSizeToFit:!0},rowAnimation:!0,rowSelection:"multiple",tableColumns:null},form:{isReserved:!1,studentNumber:"",studentName:"",schoolYearCode:"",levelCode:"",levelDescription:"",paymentTerm:0,isScholar:!1,fees:[]}}},computed:u.a.merge(Object(b["b"])({feeLists:"Fee/getAll"}),{}),methods:{getOpenSchoolYear:function(){try{var e=this;h["a"].OpenSchoolYear().then(function(t){200===t.status&&(t.data.error?e.$q.notify({color:"negative",message:t.data.error,position:"top"}):0!==t.data.length?e.schoolyears=t.data:setTimeout(function(){e.$router.push({name:"enrollment.index"}),e.$q.notify({color:"negative",message:"Please Open a School year first!",position:"top"})},200))})}catch(e){Object(d["b"])(e)}},paymentTermFieldSet:function(){var e=this;e.deleteLevel()},onGridReady:function(e){var t=this;t.grid.gridApi=e.api,t.grid.gridColumnApi=e.columnApi},onCellValueChanged:function(e){var t=this,a=u.a.find(t.form.fees,["_id",e.data._id]),o=null;if(a){if(o=JSON.parse(JSON.stringify(a)),"code"===e.colDef.field){var n=u.a.find(t.feeLists,["code",o.code]);o["description"]=n.description,o["name"]=n.name,o["paymentTerm"]=n.paymentTerm,o["unitPrice"]=n.unitPrice,o["isAnticipatedEventsAccessories"]=n.isAnticipatedEventsAccessories}else if("quantity"===e.colDef.field||"unitPrice"===e.colDef.field||"discount"===e.colDef.field)if(o.discount||(o.discount=0),"1"===o.type){var r=o["quantity"]*o.unitPrice;o["amount"]=r-o["quantity"]*o.unitPrice*(o.discount/100)}else o["amount"]=o.unitPrice-o.unitPrice*(o.discount/100);o["balance"]=o["amount"],t.form.fees.forEach(function(a,n){a._id===e.data._id&&t.form.fees.splice(n,1,o)})}},onRemoveSelected:function(){var e=this,t=e.grid.gridApi.getSelectedRows(),a=JSON.parse(JSON.stringify(e.form.fees));u.a.forEach(t,function(e,t){u.a.remove(a,function(t){return t._id===e._id})}),e.form.fees=a},onAddRow:function(e){var t=this,a=null;setTimeout(function(){var o=JSON.parse(JSON.stringify(t.form.fees));t.$nextTick(function(){var n=[{_id:Object(d["h"])(),type:"1",code:"",name:"",description:"",discount:0,paymentTerm:0,balance:0,quantity:null,amount:0,unitPrice:0,isNew:!0}];a=e?s()(e.concat(o)):s()(n.concat(o)),t.form.fees=a})},200)},cancelOperation:function(){var e=this,t=[];for(var a in e.form)""!==e.form[a]&&t.push(a);t.length?e.$q.dialog({title:"Cancel Operation",message:"You still have pending changes. Are you sure you want to leave this page?",ok:"Agree",cancel:"Disagree"}).then(function(){e.$router.push({name:"enrollment.index"}),e.$q.notify("Agreed!")}).catch(function(){e.$q.notify("Disagreed...")}):e.$router.push({name:"enrollment.index"})},addMandatoryFees:function(){var e=i()(regeneratorRuntime.mark(function e(t){var a,o,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a=this,a.form.fees=[],o=[],e.next=6,m["a"].ShowMandatoryFees();case 6:n=e.sent,n.data&&(n.data.forEach(function(e,n){var r={_id:Object(d["h"])(),type:0,code:e.code,name:e.name,discount:0,description:e.description,paymentTerm:a.form.paymentTerm,quantity:e.quantity,amount:t.unitPrice,unitPrice:t.unitPrice,balance:t.unitPrice,isMandatory:e.isMandatory,isNew:!0};a.form.isScholar?("Registration Fees"===e.name&&(r["amount"]=t.registrationFee,r["unitPrice"]=t.registrationFee,r["balance"]=t.registrationFee,r["paymentTerm"]=1),"Books"===e.name&&(r["amount"]=t.booksScholarUnitPrice,r["unitPrice"]=t.booksScholarUnitPrice,r["balance"]=t.booksScholarUnitPrice,r["paymentTerm"]=1),"Tuition Fees"===e.name&&(r["amount"]=t.scholarUnitPrice,r["unitPrice"]=t.scholarUnitPrice,r["balance"]=t.scholarUnitPrice),"Miscellaneous Fees"===e.name&&(r["amount"]=t.miscellScholarUnitPrice,r["unitPrice"]=t.miscellScholarUnitPrice,r["balance"]=t.miscellScholarUnitPrice)):("Registration Fees"===e.name&&(r["amount"]=t.registrationFee,r["unitPrice"]=t.registrationFee,r["balance"]=t.registrationFee,r["paymentTerm"]=1),"Books"===e.name&&(r["amount"]=t.booksUnitPrice,r["unitPrice"]=t.booksUnitPrice,r["balance"]=t.booksUnitPrice,r["paymentTerm"]=1),"Tuition Fees"===e.name&&(r["amount"]=t.unitPrice,r["unitPrice"]=t.unitPrice,r["balance"]=t.unitPrice),"Miscellaneous Fees"===e.name&&(r["amount"]=t.miscellUnitPrice,r["unitPrice"]=t.miscellUnitPrice,r["balance"]=t.miscellUnitPrice)),o.push(r)}),a.onAddRow(o)),e.next=12;break;case 10:e.prev=10,e.t0=e["catch"](0);case 12:case"end":return e.stop()}},e,this,[[0,10]])}));return function(t){return e.apply(this,arguments)}}(),getSelectedSchoolYear:function(e){var t=this,a=u.a.find(t.schoolyears,["code",e.value]);a&&(t.form.schoolYearCode=a.code)},deleteSchoolYear:function(){var e=this;e.form.schoolYearCode=""},mapSchoolYear:function(e){return u.a.map(e,function(e){return{label:e.code,value:e.code}})},getSchoolYear:function(e,t){var a=this,o=[],n={terms:e};h["a"].PickList(n).then(function(e){if(200===e.status)if(e.data.error)a.$q.notify({color:"negative",message:e.data.error,position:"top"}),void 0!==t&&t(o);else{var n=JSON.parse(JSON.stringify(e.data));o=a.mapSchoolYear(n),void 0!==t&&(a.schoolyears=n,t(o))}},function(e){a.$q.notify({message:e.response.data.error,position:"top",type:"negative"})})},getSelectedLevel:function(e){var t=this,a=u.a.find(t.levels,["code",e.value]);a&&(t.form.levelCode=a.code,t.form.levelDescription=a.name+" - "+a.description,t.addMandatoryFees(a))},deleteLevel:function(){var e=this;e.form.levelCode="",e.form.levelDescription="",e.form.fees=[]},mapLevel:function(e){return u.a.map(e,function(e){return{label:e.code+" - "+e.name,value:e.code}})},getLevel:function(e,t){var a=this,o=[],n={terms:e};p["a"].PickList(n).then(function(e){if(200===e.status)if(e.data.error)a.$q.notify({color:"negative",message:e.data.error,position:"top"}),void 0!==t&&t(o);else{var n=JSON.parse(JSON.stringify(e.data));o=a.mapLevel(n),void 0!==t&&(a.levels=n,t(o))}},function(e){a.$q.notify({message:e.response.data.error,position:"top",type:"negative"})})},getSelectedStudent:function(e){var t=this,a=u.a.find(t.students,["studentNumber",e.value]);console.log(a,e),a&&(t.form.studentNumber=a.studentNumber,t.form.studentName=a.lastName+" "+a.givenName)},deleteStudent:function(){var e=this;e.form.studentNumber="",e.form.studentName=""},mapStudent:function(e){return u.a.map(e,function(e){return{label:e.studentNumber+" - "+e.lastName+" "+e.givenName,value:e.studentNumber}})},getStudent:function(e,t){var a=this,o=[],n={terms:e};v["a"].PickList(n).then(function(e){if(200===e.status)if(e.data.error)a.$q.notify({color:"negative",message:e.data.error,position:"top"}),void 0!==t&&t(o);else{var n=JSON.parse(JSON.stringify(e.data));o=a.mapStudent(n),void 0!==t&&(a.students=n,t(o))}},function(e){a.$q.notify({message:e.response.data.error,position:"top",type:"negative"})})},saveItem:function(){var e=this;try{var t=e.form;f["a"].Store(t).then(function(t){200===t.status&&(t.data.error?e.$q.notify({color:"negative",message:t.data.error,position:"top"}):(e.$q.notify({color:"positive",message:"Enrollment Added!",position:"top"}),e.$router.push({name:"enrollment.edit",query:{id:t.data.id}})))},function(t){e.$q.notify({color:"negative",message:t.response.data.error,position:"top"})})}catch(e){console.log(e),Object(d["b"])()}}}},k=N,q=a("2877"),w=Object(q["a"])(k,o,n,!1,null,null,null);w.options.__file="Create.vue";t["default"]=w.exports}}]);