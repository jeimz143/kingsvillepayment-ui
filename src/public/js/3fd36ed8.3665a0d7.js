(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["3fd36ed8"],{"02b0":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-search",{attrs:{placeholder:"Type Fee Code",autofocus:""},model:{value:e.feeItemCode,callback:function(t){e.feeItemCode=t},expression:"feeItemCode"}},[a("q-autocomplete",{attrs:{"min-characters":0},on:{selected:e.getFeeItem,search:e.getFeeCode}})],1)],1)},n=[];o._withStripped=!0;a("7f7f");var i=a("2b0e"),r=a("2ef0"),s=a.n(r),l=a("7bb4"),c=i["default"].extend({name:"CodeFeeInput",created:function(){this.params.value&&(this.feeItemCode=this.params.value)},mounted:function(){var e=this;e.getFeeCode()},data:function(){return{feeItemCode:"",feeItemLists:[]}},methods:{mapFeeItems:function(e){return s.a.map(e,function(e){return{label:e.code+" - "+e.name+" "+e.description,value:e.code}})},getFeeItem:function(e){this.feeItemCode=e.value,this.params.stopEditing()},getFeeCode:function(e,t){var a=this,o=[],n={terms:e,branch:a.params.context.form.branch};l["a"].PickList(n).then(function(e){if(200===e.status)if(e.data.error)a.$q.notify({color:"negative",message:e.data.error,position:"top"}),void 0!==t&&t(o);else{var n=JSON.parse(JSON.stringify(e.data));o=a.mapFeeItems(n),void 0!==t&&(a.$store.dispatch("Fee/listAll",n),t(o))}},function(e){a.$q.notify({message:e.response.data.error,position:"top",type:"negative"})})},getValue:function(){return this.feeItemCode}}}),d=c,u=a("2877"),m=Object(u["a"])(d,o,n,!1,null,null,null);m.options.__file="CodeFeeInput.vue";t["a"]=m.exports},"0676":function(e,t){function a(){throw new TypeError("Invalid attempt to spread non-iterable instance")}e.exports=a},"11b0":function(e,t,a){var o=a("2a06"),n=a("883d");function i(e){if(n(Object(e))||"[object Arguments]"===Object.prototype.toString.call(e))return o(e)}e.exports=i},"20fd":function(e,t,a){"use strict";var o=a("d9f6"),n=a("aebd");e.exports=function(e,t,a){t in e?o.f(e,t,n(0,a)):e[t]=a}},2236:function(e,t){function a(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}e.exports=a},"2a06":function(e,t,a){e.exports=a("d2d5")},"2fbd":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-input",{attrs:{type:"number",autofocus:""},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete"]))return null;e.model=0},blur:e.onBlur,focus:function(t){e.parseTwoDecimal()}},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)},n=[];o._withStripped=!0;var i=a("2b0e"),r=i["default"].extend({name:"NumberInput",created:function(){this.params.value&&(this.model=this.params.value)},data:function(){return{model:0}},methods:{parseTwoDecimal:function(){},getValue:function(){return this.model},onBlur:function(){this.params.stopEditing()}}}),s=r,l=a("2877"),c=Object(l["a"])(s,o,n,!1,null,null,null);c.options.__file="NumberInput.vue";t["a"]=c.exports},"448a":function(e,t,a){var o=a("2236"),n=a("11b0"),i=a("0676");function r(e){return o(e)||n(e)||i()}e.exports=r},"549b":function(e,t,a){"use strict";var o=a("d864"),n=a("63b6"),i=a("241e"),r=a("b0dc"),s=a("3702"),l=a("b447"),c=a("20fd"),d=a("7cd6");n(n.S+n.F*!a("4ee1")(function(e){Array.from(e)}),"Array",{from:function(e){var t,a,n,u,m=i(e),f="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,h=void 0!==v,b=0,g=d(m);if(h&&(v=o(v,p>2?arguments[2]:void 0,2)),void 0==g||f==Array&&s(g))for(t=l(m.length),a=new f(t);t>b;b++)c(a,b,h?v(m[b],b):m[b]);else for(u=g.call(m),a=new f;!(n=u.next()).done;b++)c(a,b,h?r(u,v,[n.value,b],!0):n.value);return a.length=b,a}})},"54a1":function(e,t,a){a("6c1c"),a("1654"),e.exports=a("95d5")},"7e0e":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"form q-pa-lg"},[a("form",{attrs:{action:"post"},on:{submit:function(t){return t.preventDefault(),e.saveItem(t)}}},[a("div",{staticClass:"row gutter-sm"},[a("div",{staticClass:"col-xs-12 btn-actions"},[a("div",{staticClass:"row gutter-sm float-right"},[a("div",["Registrar"!==e.user.role&&"Administrator"!==e.user.role||0!==e.form.documentStatus?e._e():a("q-btn",{staticClass:"float-right",attrs:{icon:"done",color:"primary"},on:{click:e.disapprove}},[e._v("Reject")])],1),a("div",[a("q-btn",{staticClass:"float-right",attrs:{icon:"filter_none",color:"tertiary"},on:{click:function(t){e.$router.push({name:"enrollment.statementofaccount",query:{id:e.$route.query.id}})}}},[e._v("\n                View Statement of Account\n              ")])],1)])]),a("div",{staticClass:"col-xs-12 col-md-6"},[a("q-field",{attrs:{label:"Document Status:",orientation:"vertical"}},[a("q-input",{attrs:{readonly:""},model:{value:e.theDocumentStatus,callback:function(t){e.theDocumentStatus=t},expression:"theDocumentStatus"}})],1)],1),a("div",{staticClass:"col-xs-12 col-md-6"}),a("div",{staticClass:"col-xs-12 col-md-6"},[a("q-field",{attrs:{label:"Select School Year:",orientation:"vertical"}},[a("q-search",{attrs:{placeholder:"Type School Year.",readonly:""},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete"]))return null;e.deleteSchoolYear()}},model:{value:e.form.schoolYearCode,callback:function(t){e.$set(e.form,"schoolYearCode",t)},expression:"form.schoolYearCode"}},[a("q-autocomplete",{attrs:{"min-characters":0},on:{selected:e.getSelectedSchoolYear,search:e.getSchoolYear}})],1)],1)],1),a("div",{staticClass:"col-xs-12 col-md-6"},[a("q-field",{attrs:{label:"Select School Branch:",orientation:"vertical"}},[a("q-input",{attrs:{readonly:""},model:{value:e.form.branch,callback:function(t){e.$set(e.form,"branch",t)},expression:"form.branch"}})],1)],1),a("div",{staticClass:"col-xs-12 col-md-6"},[a("q-field",{attrs:{label:"Is Reserved?",orientation:"vertical"}},[a("q-toggle",{attrs:{label:e.form.isReserved?"Reserved":"Not Reserved",readonly:"",disable:!0},model:{value:e.form.isReserved,callback:function(t){e.$set(e.form,"isReserved",t)},expression:"form.isReserved"}})],1)],1),a("div",{staticClass:"col-xs-12 col-md-6"},[a("q-field",{attrs:{label:"Student's No.:",orientation:"vertical"}},[a("q-input",{attrs:{readonly:""},model:{value:e.form.studentNumber,callback:function(t){e.$set(e.form,"studentNumber",t)},expression:"form.studentNumber"}})],1)],1),a("div",{staticClass:"col-xs-12 col-md-6"},[a("q-field",{attrs:{label:"Student's Name.:",orientation:"vertical"}},[a("q-input",{attrs:{readonly:""},model:{value:e.form.studentName,callback:function(t){e.$set(e.form,"studentName",t)},expression:"form.studentName"}})],1)],1),a("div",{staticClass:"col-xs-12 col-md-6"},[a("q-field",{attrs:{label:"Is Scholar or With Voucher:","label-width":"4",orientation:"vertical"}},[a("q-select",{attrs:{readonly:"",options:[{label:"Yes",value:!0},{label:"No",value:!1}]},model:{value:e.form.isScholar,callback:function(t){e.$set(e.form,"isScholar",t)},expression:"form.isScholar"}})],1)],1),a("div",{staticClass:"col-xs-12 col-md-6"},[a("q-field",{attrs:{label:"In-Cash / Monthly Base","label-width":"4",orientation:"vertical"}},[a("q-select",{attrs:{inline:"",color:"secondary",radio:"",options:[{label:"",value:0},{label:"In-Cash",value:1},{label:"Monthly",value:2}],readonly:""},on:{input:e.paymentTermFieldSet},model:{value:e.form.paymentTerm,callback:function(t){e.$set(e.form,"paymentTerm",t)},expression:"form.paymentTerm"}})],1)],1),0!==e.form.paymentTerm?a("div",{staticClass:"col-xs-12 col-md-6"},[a("q-field",{attrs:{label:"Grade/Level Code",orientation:"vertical"}},[a("q-search",{attrs:{placeholder:"Select Grade / Level Code",readonly:""},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete"]))return null;e.deleteLevel()}},model:{value:e.form.levelCode,callback:function(t){e.$set(e.form,"levelCode",t)},expression:"form.levelCode"}},[a("q-autocomplete",{attrs:{"min-characters":0,readonly:""},on:{selected:e.getSelectedLevel,search:e.getLevel}})],1)],1)],1):e._e(),0!==e.form.paymentTerm?a("div",{staticClass:"col-xs-12 col-md-6"},[a("q-field",{attrs:{label:"Grade/Level Description",orientation:"vertical"}},[a("q-input",{attrs:{readonly:""},model:{value:e.form.levelDescription,callback:function(t){e.$set(e.form,"levelDescription",t)},expression:"form.levelDescription"}})],1)],1):e._e(),0!==e.form.fees.length&&2!==e.form.documentStatus&&3!==e.form.documentStatus?a("div",{staticClass:"col-xs-12"},[a("q-btn",{staticClass:"float-right",attrs:{flat:"",color:"positive",round:""},on:{click:function(t){e.onAddRow()}}},[a("q-icon",{attrs:{name:"add",size:"sm"}}),a("q-tooltip",[e._v("\n              Add New Row\n            ")])],1),a("q-btn",{staticClass:"float-right",attrs:{flat:"",color:"negative",round:""},on:{click:function(t){e.onRemoveSelected()}}},[a("q-icon",{attrs:{name:"delete",size:"sm"}}),a("q-tooltip",[e._v("\n              Remove Selected Item\n            ")])],1)],1):e._e(),0!==e.form.fees.length?a("div",{staticClass:"col-xs-12"},[a("AgGrid",{staticClass:"ag-theme-material ag-edit-page",attrs:{rowData:e.form.fees,rowSelection:e.grid.rowSelection,rowAnimation:e.grid.rowAnimation,gridOptions:e.grid.gridOptions,defaultColDef:e.grid.defaultColDef,columnDefs:e.grid.tableColumns,frameworkComponents:e.grid.frameworkComponents,overlayNoRowsTemplate:e.grid.overlayNoRowsTemplate,suppressRowClickSelection:!0,context:e.grid.context},on:{"grid-ready":e.onGridReady,"cell-value-changed":e.onCellValueChanged}})],1):e._e(),a("div",{staticClass:"col-xs-12"},[2!==e.form.documentStatus?a("q-btn",{on:{click:function(t){e.cancelOperation()}}},[e._v("Cancel")]):e._e(),2===e.form.documentStatus?a("q-btn",{on:{click:function(t){e.$router.push({name:"enrollment.index"})}}},[e._v("Return to list")]):e._e(),"Registrar"!==e.user.role&&"Administrator"!==e.user.role||1!==e.form.documentStatus?e._e():a("q-btn",{staticClass:"float-right",attrs:{icon:"save",color:"warning"},on:{click:e.saveAndPost}},[e._v("Save And Submit")]),2!==e.form.documentStatus&&3!==e.form.documentStatus?a("q-btn",{staticClass:"float-right q-mr-sm",attrs:{type:"submit",icon:"add",color:"primary",loading:e.loading}},[e._v("Save")]):e._e()],1)])])])])},n=[];o._withStripped=!0;a("96cf");var i=a("c973"),r=a.n(i),s=a("448a"),l=a.n(s),c=(a("ac6a"),a("7f7f"),a("7514"),a("2ef0")),d=a.n(c),u=a("ed08"),m=a("c242"),f=a("7bb4"),p=a("7882"),v=a("1723"),h=a("659a"),b=a("2f62"),g=a("02b0"),y=a("2fbd"),S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[3!==e.params.context.form.documentStatus?a("div",{staticClass:"row gutter-sm"},[e.params.data.isPaid||2===e.params.context.form.documentStatus||e.params.data.isNew||0===e.params.data.quantity?e._e():a("div",[a("q-btn",{staticClass:"float-right",attrs:{flat:"",color:"positive",round:""},on:{click:function(t){e.addPayment()}}},[a("q-icon",{attrs:{name:"payment",size:"sm"}}),a("q-tooltip",[e._v("\n          Payments\n        ")])],1)],1),e.params.data.isPaid&&!e.params.data.isNew||2===e.params.context.form.documentStatus?a("div",[a("q-btn",{staticClass:"float-right",attrs:{flat:"",color:"primary",round:""},on:{click:function(t){e.addPayment()}}},[a("q-icon",{attrs:{name:"view_list",size:"sm"}}),a("q-tooltip",[e._v("\n          View Summary Payments\n        ")])],1)],1):e._e(),e.params.data.isPaid?a("div",[a("q-btn",{staticClass:"float-right full-width",attrs:{flat:"",color:"positive",disabled:""}},[e._v("\n        Paid\n      ")])],1):e._e()]):e._e()])},C=[];S._withStripped=!0;var P=a("2b0e"),w=P["default"].extend({name:"EditCellButtonRenderer",created:function(){console.log(this.params.context.form.documentStatus)},data:function(){return{}},computed:d.a.merge(Object(b["b"])({}),{}),methods:{addPayment:function(){var e=this;e.$router.push({name:"payment.edit",query:{feeId:e.params.data._id,enrollmentId:e.$route.query.id}})}}}),q=w,N=a("2877"),k=Object(N["a"])(q,S,C,!1,null,null,null);k.options.__file="EditCellButtonRenderer.vue";var x=k.exports,_=["Fee","Item"],F=["","In-Cash","Monthly Basis"],T={name:"EnrollmentEdit",beforeMount:function(){var e=this;e.grid.context=e,e.grid.overlayNoRowsTemplate='<span style="padding: 10px; border: 1px solid #eceff1; background: #fafafad6; width: 50%;">No rows to display <q-icon name=""></span>',e.grid.gridOptions={singleClickEdit:!0},e.grid.frameworkComponents={CodeFeeInput:g["a"],NumberInput:y["a"],EditCellButtonRenderer:x},e.grid.tableColumns=[{headerName:"No",field:"payment_fee_no",width:133,sortable:!0,filter:!0,editable:!1,resizable:!0,suppressSizeToFit:!0,checkboxSelection:function(e){return!e.data.isMandatory&&!e.data.isPaid},cellClass:function(e){return e.data.isMandatory||e.data.isPaid?"not-allowed":""}},{headerName:"Is Paid?",field:"isPaid",sortable:!0,filter:!0,resizable:!0,suppressSizeToFit:!0,cellEditor:"NumberInput",editable:!1,cellClass:["not-allowed"],cellStyle:function(t){var a=t.data.payments,o=e.paymentStatus(a);return 1===o?{"background-color":"#21ba45",color:"white"}:2===o?{"background-color":"#f2c037",color:"white"}:{"background-color":"red",color:"white"}},valueFormatter:function(t){var a=t.data.payments,o=e.paymentStatus(a);return 1===o?"Fully Paid":2===o?"Partially Paid":"Not Paid"}},{headerName:"Type",field:"type",sortable:!0,filter:!0,resizable:!0,suppressSizeToFit:!0,editable:!1,cellEditor:"agSelectCellEditor",cellEditorParams:{values:[0,1]},cellClass:["not-allowed"],valueFormatter:function(e){return Object(u["g"])(_,e.value)},valueParser:function(e){return Object(u["f"])(_,e.newValue)}},{headerName:"Code",field:"code",sortable:!0,filter:!0,resizable:!0,suppressSizeToFit:!0,editable:function(e){return!e.data.isMandatory&&!e.data.isPaid},cellClass:function(e){return e.data.isMandatory||e.data.isPaid?["not-allowed"]:[]},cellEditor:"CodeFeeInput"},{headerName:"Name",field:"name",sortable:!0,filter:!0,resizable:!0,suppressSizeToFit:!0,editable:function(e){return 0!==e.data.type&&!0!==e.data.isPaid},cellClass:function(e){return 0!==e.data.type&&!0!==e.data.isPaid?[]:["not-allowed"]}},{headerName:"Description",field:"description",sortable:!0,filter:!0,resizable:!0,suppressSizeToFit:!0,editable:function(e){return!e.data.isPaid},cellClass:function(e){return e.data.isPaid?["not-allowed"]:[""]}},{headerName:"Payment Term",field:"paymentTerm",sortable:!0,filter:!0,resizable:!0,suppressSizeToFit:!0,editable:function(e){return 0!==e.data.type&&!0!==e.data.isPaid},cellClass:function(e){return 0!==e.data.type&&!0!==e.data.isPaid?[]:["not-allowed"]},cellEditor:"agSelectCellEditor",cellEditorParams:{values:[0,1,2]},valueFormatter:function(e){return Object(u["g"])(F,e.value)},valueParser:function(e){return Object(u["f"])(F,e.newValue)}},{headerName:"Quantity",field:"quantity",sortable:!0,filter:!0,resizable:!0,suppressSizeToFit:!0,cellEditor:"NumberInput",editable:function(e){return null!==e.data.type&&(1===e.data.type||"1"===e.data.type)&&!0!==e.data.isPaid},cellClass:function(e){return null===e.data.type||1!==e.data.type&&"1"!==e.data.type||!0===e.data.isPaid?"not-allowed":""},valueFormatter:function(e){return e.data.quantity?parseFloat(Object(u["e"])(e.data.quantity)).toFixed(2):"0.00"}},{headerName:"Unit Price",field:"unitPrice",sortable:!0,filter:!0,resizable:!0,suppressSizeToFit:!0,cellEditor:"NumberInput",editable:!1,cellClass:["not-allowed"],valueFormatter:function(e){return e.data.unitPrice?Object(u["e"])(e.data.unitPrice):"0.00"}},{headerName:"Discount (%)",field:"discount",sortable:!0,filter:!0,resizable:!0,suppressSizeToFit:!0,cellEditor:"NumberInput",editable:function(e){return null!==e.data.type&&(1===e.data.type||"1"===e.data.type)&&!0!==e.data.isPaid},cellClass:function(e){return null===e.data.type||1!==e.data.type&&"1"!==e.data.type||!0===e.data.isPaid?["not-allowed"]:[]},valueFormatter:function(e){return e.data.discount?Object(u["e"])(e.data.discount):"0.00"}},{headerName:"Amount",field:"amount",sortable:!0,filter:!0,resizable:!0,suppressSizeToFit:!0,cellEditor:"NumberInput",editable:!1,cellClass:["not-allowed"],valueFormatter:function(e){return e.data.amount?Object(u["e"])(e.data.amount):"0.00"}},{headerName:"Balance",field:"balance",sortable:!0,filter:!0,resizable:!0,suppressSizeToFit:!0,cellEditor:"NumberInput",editable:!1,cellClass:["not-allowed"],valueFormatter:function(e){return e.data.balance?Object(u["e"])(e.data.balance):"0.00"}},{headerName:"Remarks",field:"remarks",sortable:!0,filter:!0,editable:function(e){return!e.data.isPaid},resizable:!0,suppressSizeToFit:!0,cellEditor:"agLargeTextCellEditor"},{headerName:"Actions",field:"_id",cellRenderer:"EditCellButtonRenderer",pinned:"right"}]},mounted:function(){var e=this;e.$route.query.id?(e.showItem(),setTimeout(function(){e.grid.gridApi=e.grid.gridOptions.api,e.grid.gridColumnApi=e.grid.gridOptions.columnApi},300)):(e.$q.notify({message:"Whoops! Please select Enrollment Document",position:"top",color:"negative"}),e.$router.push({name:"enrollment.index"}))},data:function(){return{loading:!1,levels:[],students:[],grid:{gridApi:null,overlayNoRowsTemplate:null,gridColumnApi:null,frameworkComponents:null,gridOptions:{},defaultColDef:{sortable:!0,resizable:!0,suppressSizeToFit:!0},rowAnimation:!0,rowSelection:"multiple",tableColumns:null},originalRow:{studentNumber:"",studentName:"",levelCode:"",levelDescription:"",paymentTerm:0,fees:[]},form:{studentNumber:"",studentName:"",levelCode:"",levelDescription:"",paymentTerm:0,fees:[]}}},sockets:{ShowEnrollment:function(){}},computed:d.a.merge(Object(b["b"])({feeLists:"Fee/getAll",user:"Auth/getUser"}),{hasAPayments:function(){var e=this,t=d.a.filter(e.form.fees,function(e,t){return e.payments?0!==e.payments.length:[]});return 0!==t.length},theDocumentStatus:function(){var e=this,t=0;switch(e.form.documentStatus){case 1:t="Enrolled";break;case 2:t="Posted";break;case 3:t="Rejected";break;default:t="Pending"}return t}}),methods:{paymentStatus:function(e){var t=d.a.filter(e,["isPaid",!0]).length;return 0===t?0:t===e.length?1:t<e.length?2:void 0},paymentTermFieldSet:function(){var e=this;e.deleteLevel()},onGridReady:function(e){var t=this;t.grid.gridApi=e.api,t.grid.gridColumnApi=e.columnApi},onCellValueChanged:function(e){var t=this,a=d.a.find(t.form.fees,["_id",e.data._id]),o=null;if(a){if(o=JSON.parse(JSON.stringify(a)),"code"===e.colDef.field){var n=d.a.find(t.feeLists,["code",o.code]);o["description"]=n.description,o["name"]=n.name,o["paymentTerm"]=n.paymentTerm,o["unitPrice"]=n.unitPrice,o["isAnticipatedEventsAccessories"]=n.isAnticipatedEventsAccessories}else if("quantity"===e.colDef.field||"unitPrice"===e.colDef.field||"discount"===e.colDef.field)if(o.discount||(o.discount=0),"1"===o.type||1===o.type){var i=o["quantity"]*o.unitPrice;o["amount"]=i-o["quantity"]*o.unitPrice*(o.discount/100)}else o["amount"]=o.unitPrice-o.unitPrice*(o.discount/100);o["balance"]=o["amount"],t.form.fees.forEach(function(a,n){a._id===e.data._id&&t.form.fees.splice(n,1,o)})}},onRemoveSelected:function(){var e=this,t=e.grid.gridApi.getSelectedRows(),a=JSON.parse(JSON.stringify(e.form.fees));d.a.forEach(t,function(e,t){d.a.remove(a,function(t){return t._id===e._id})}),e.form.fees=a},onAddRow:function(e){var t=this,a=null;setTimeout(function(){var o=JSON.parse(JSON.stringify(t.form.fees));t.$nextTick(function(){var n=[{_id:Object(u["h"])(),type:1,code:"",name:"",description:"",paymentTerm:1,quantity:null,amount:0,unitPrice:0,isNew:!0}];a=e?l()(e.concat(o)):l()(n.concat(o)),t.form.fees=a})},200)},cancelOperation:function(){var e=this,t=[];for(var a in e.form)""!==e.form[a]&&t.push(a);t.length?e.$q.dialog({title:"Cancel Operation",message:"You still have pending changes. Are you sure you want to leave this page?",ok:"Agree",cancel:"Disagree"}).then(function(){e.$router.push({name:"enrollment.index"}),e.$q.notify("Agreed!")}).catch(function(){e.$q.notify("Disagreed...")}):e.$router.push({name:"enrollment.index"})},addMandatoryFees:function(){var e=r()(regeneratorRuntime.mark(function e(t){var a,o,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a=this,a.form.fees=[],o=[],e.next=6,f["a"].ShowMandatoryFees();case 6:n=e.sent,n.data&&(n.data.forEach(function(e,n){var i={_id:Object(u["h"])(),type:0,code:e.code,name:e.name,discount:0,description:e.description,paymentTerm:a.form.paymentTerm,quantity:e.quantity,amount:t.unitPrice,unitPrice:t.unitPrice,balance:t.unitPrice,isMandatory:e.isMandatory,isNew:!0};a.form.isScholar?("Registration Fees"===e.name&&(i["amount"]=t.registrationFee,i["unitPrice"]=t.registrationFee,i["balance"]=t.registrationFee,i["paymentTerm"]=1),"Books"===e.name&&(i["amount"]=t.booksScholarUnitPrice,i["unitPrice"]=t.booksScholarUnitPrice,i["balance"]=t.booksScholarUnitPrice,i["paymentTerm"]=1),"Tuition Fees"===e.name&&(i["amount"]=t.scholarUnitPrice,i["unitPrice"]=t.scholarUnitPrice,i["balance"]=t.scholarUnitPrice,i["remarks"]=a.form.remarks,i["discount"]=a.form.discount),"Miscellaneous Fees"===e.name&&(i["amount"]=t.miscellScholarUnitPrice,i["unitPrice"]=t.miscellScholarUnitPrice,i["balance"]=t.miscellScholarUnitPrice)):("Registration Fees"===e.name&&(i["amount"]=t.registrationFee,i["unitPrice"]=t.registrationFee,i["balance"]=t.registrationFee,i["paymentTerm"]=1),"Books"===e.name&&(i["amount"]=t.booksUnitPrice,i["unitPrice"]=t.booksUnitPrice,i["balance"]=t.booksUnitPrice,i["paymentTerm"]=1),"Tuition Fees"===e.name&&(0!==a.form.discount?(i["discount"]=a.form.discount,i["unitPrice"]=t.unitPrice,i["amount"]=t.unitPrice-t.unitPrice*(a.form.discount/100),i["balance"]=t.unitPrice-t.unitPrice*(a.form.discount/100),i["remarks"]=a.form.remarks):(i["amount"]=t.unitPrice,i["unitPrice"]=t.unitPrice,i["balance"]=t.unitPrice)),"Miscellaneous Fees"===e.name&&(i["amount"]=t.miscellUnitPrice,i["unitPrice"]=t.miscellUnitPrice,i["balance"]=t.miscellUnitPrice)),o.push(i)}),a.onAddRow(o)),e.next=12;break;case 10:e.prev=10,e.t0=e["catch"](0);case 12:case"end":return e.stop()}},e,this,[[0,10]])}));return function(t){return e.apply(this,arguments)}}(),getSelectedSchoolYear:function(e){var t=this,a=d.a.find(t.schoolyears,["code",e.value]);a&&(t.form.schoolYearCode=a.code)},deleteSchoolYear:function(){var e=this;e.form.schoolYearCode=""},mapSchoolYear:function(e){return d.a.map(e,function(e){return{label:e.code,value:e.code}})},getSchoolYear:function(e,t){var a=this,o=[],n={terms:e};h["a"].PickList(n).then(function(e){if(200===e.status)if(e.data.error)a.$q.notify({color:"negative",message:e.data.error,position:"top"}),void 0!==t&&t(o);else{var n=JSON.parse(JSON.stringify(e.data));o=a.mapSchoolYear(n),void 0!==t&&(a.schoolyears=n,t(o))}},function(e){a.$q.notify({message:e.response.data.error,position:"top",type:"negative"})})},getSelectedLevel:function(e){var t=this,a=d.a.find(t.levels,["code",e.value]);a&&(t.form.levelCode=a.code,t.form.levelDescription=a.name+" - "+a.description,t.addMandatoryFees(a))},deleteLevel:function(){var e=this;e.form.levelCode="",e.form.levelDescription="",e.form.fees=[]},mapLevel:function(e){return d.a.map(e,function(e){return{label:e.code+"-"+e.name,value:e.code}})},getLevel:function(e,t){var a=this,o=[],n={terms:e};p["a"].PickList(n).then(function(e){if(200===e.status)if(e.data.error)a.$q.notify({color:"negative",message:e.data.error,position:"top"}),void 0!==t&&t(o);else{var n=JSON.parse(JSON.stringify(e.data));o=a.mapLevel(n),void 0!==t&&(a.levels=n,t(o))}},function(e){a.$q.notify({message:e.response.data.error,position:"top",type:"negative"})})},getSelectedStudent:function(e){var t=this,a=d.a.find(t.students,["studentNumber",e.value]);a&&(t.form.studentNumber=a.studentNumber,t.form.studentName=a.lastName+" "+a.givenName)},deleteStudent:function(){var e=this;e.form.studentNumber="",e.form.studentName=""},mapStudent:function(e){return d.a.map(e,function(e){return{label:e.studentNumber+"-"+e.lastName+" "+e.givenName,value:e.studentNumber}})},getStudent:function(e,t){var a=this,o=[],n={terms:e};v["a"].PickList(n).then(function(e){if(200===e.status)if(e.data.error)a.$q.notify({color:"negative",message:e.data.error,position:"top"}),void 0!==t&&t(o);else{var n=JSON.parse(JSON.stringify(e.data));o=a.mapStudent(n),void 0!==t&&(a.students=n,t(o))}},function(e){a.$q.notify({message:e.response.data.error,position:"top",type:"negative"})})},saveItem:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;try{var a=t.form;m["a"].Update(a).then(function(a){200===a.status&&(a.data.error?t.$q.notify({color:"negative",message:a.data.error,position:"top"}):(!0!==e&&t.$q.notify({color:"positive",message:"Enrollment Updated!",position:"top"}),t.showItem()))},function(e){t.$q.notify({color:"negative",message:e.response.data.error,position:"top"})})}catch(e){console.log(e),Object(u["b"])()}},saveAndPost:function(){var e=this;try{e.$q.dialog({title:"Save And Submit Enrollment",message:"This will post the document. Once posted, it cannot be edited. Are you sure?",ok:"Save and Post",cancel:"Cancel"}).then(function(){var t={form:e.form};m["a"].UpdatePost(t).then(function(t){200===t.status&&(t.data.error?e.$q.notify({color:"negative",message:t.data.error,position:"top"}):(e.$q.notify({color:"positive",message:"Document was posted.",position:"top"}),e.showCreditNote(),e.isPageReloading=!0))},function(e){throw e})}).catch(function(e){throw e})}catch(e){console.log(e),Object(u["b"])()}},disapprove:function(){var e=this;try{e.$q.dialog({title:"Disapprove Enrollment Application",message:"This will disapprove the enrollment. Once Disapproved, The Student 's enrollment application will be rejected. Are you sure?",ok:"Disapprove",cancel:"Cancel"}).then(function(){var t={form:e.form};m["a"].Disapprove(t).then(function(t){200===t.status&&(t.data.error?e.$q.notify({color:"negative",message:t.data.error,position:"top"}):(e.$q.notify({color:"positive",message:"Enrollment has been successfully enrolled.",position:"top"}),e.showItem(),e.isPageReloading=!0))},function(e){throw e})}).catch(function(e){throw e})}catch(e){console.log(e),Object(u["b"])()}},showItem:function(){var e=this;try{var t=e.$route.query.id;if(null!==t){var a={_id:t};m["a"].Show(a).then(function(t){200===t.status&&(t.data.error?e.$q.notify({color:"negative",message:t.data.error,position:"top"}):(e.form=t.data,e.originalRow=JSON.parse(JSON.stringify(t.data)),0===e.form.fees.length&&p["a"].ShowByCode({code:e.form.levelCode}).then(function(t){0===e.form.fees.length&&e.addMandatoryFees(t.data),setTimeout(function(){e.saveItem(!0)},800)})))},function(t){e.$q.notify({position:"top",message:t.response.data.error,type:"negative",color:"negative"})})}}catch(e){console.log(e),Object(u["b"])(e)}}}},O=T,A=Object(N["a"])(O,o,n,!1,null,null,null);A.options.__file="Edit.vue";t["default"]=A.exports},"883d":function(e,t,a){e.exports=a("54a1")},"95d5":function(e,t,a){var o=a("40c3"),n=a("5168")("iterator"),i=a("481b");e.exports=a("584a").isIterable=function(e){var t=Object(e);return void 0!==t[n]||"@@iterator"in t||i.hasOwnProperty(o(t))}},d2d5:function(e,t,a){a("1654"),a("549b"),e.exports=a("584a").Array.from}}]);